
<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="google" value="notranslate">
    <title>COA Tool</title>
    <style>
      body { text-align: center; }
      button, textarea { 
        display: inline-block; 
        margin: 8px;
        vertical-align: middle;
      }
      textarea {
        width: calc(40% - 50px);
      }
      button { 
        font-size: 100%; 
        padding: 6px; 
      }

      textarea {
        font-size: 110%;
        height: 90vh;
      }
    </style> 
  </head>

  <body>
    <textarea name="" id="input" placeholder="Input"></textarea>
    <button onclick="lookup()">Convert</button>
    <textarea name="" id="output" placeholder="Output"></textarea>
    
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

    <script>
      $.ajaxSetup({"error":function(XMLHttpRequest,textStatus, errorThrown) {   
            alert(textStatus);
            alert(errorThrown);
            alert(XMLHttpRequest.responseText);
      }});

      function lookup() {
        var input = $("#input").val();
        var matches = input.match(/\b(\d{6}|\d{10})\b/gm);
        $.getJSON("/json/coa", function( map ) {
          var x = "Mapping:\n";
          for (i in matches) {
            var r = map[matches[i]]?map[matches[i]]:matches[i];
            x = x + matches[i] + " : " + r + "\n";
            input = input.replace(matches[i], r);
          }
          $("#output").val(x+"\n\nConverted:\n"+input);        
        });        
      }
    </script>    
  </body>
</html>
 
